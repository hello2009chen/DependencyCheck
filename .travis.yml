language: java
jdk: oraclejdk7
script: 
  - if [ ! -z "$TRAVIS_TAG" ]; then travis_wait 20 mvn install site site:stage -DreleaseTesting; else travis_wait 15 mvn install -DreleaseTesting; fi

env:
  global:
  - secure: "ZUzhWfpXJw/oAeDlUkDFkEJMT0T7kCN3d7ah8urkL2B0KFfKOqQagkbXkgvDa1SYud8VdcnoGa69LfkEr5IrdqW7R4bEYZAiN5swm4Z0iO8t53szVspm2f+O9jQ44O/sfOfpfLxWUUuhdc7Vbrszp+tSszxdPmssWL+f5a/mfWs="
  - secure: "pmFymoI7qH0Kna3NkcHrqLiTVWKmrhwqA4Z9U6XLhWDQxcs5g94wCCKpGB6Lkz9mkvRxBRFpZZelnXJa9W9mnuVOMIa5tQfS5gBuaNXOe7AXXdc+Y2975OR9sSfvf16FxLFvNJILmZq+bpMLs+EXaQvjYQHW2O6OWZdLhAPVG6A="
  - secure: "POs1Icgp59RdhkzzCdDwVeAk+rUC2Vz0PeFw0lDZgSZ5oTHVQfS7GO3BjLSUUJOoD+ZZy/rQo8AeqgcVAtAzrx1SlDsf45EFY2VuZ4bXNe0Hw8sfA3TNyhiI2DrUXkNL0L3uReytqwbH32tza6RFgK4n920BI6hruu1Yjwz1TS0="
  - secure: "CuxNw1fSw7gT8Wb4woAA0PrePs6Sn08SaATu0iSOt/HS8T9HfDAeIVHE+8RqT2/LM9b3XBEA2oPd1vXN7D9Tn6R3LUNOmiLjG6ZhDKAMV6d7RSELHnF3876BshEDESn4BNoWpYaEgRtn+uUdwRmceWE6d8fHOJy/c59rNe5OZAU="
  - secure: "Bh5LAk8XQnJ885jc/Lli2fhPKDx0TNZRxcJMnNo96EgwOnD+Zhw+v3u/DMCgyyrRToM8Bkca/HktrlZaRTk2htsdKZZ3RHFMCXO0fXCgpcf+wkaSYDF/lnErpSJG3Lrz8ILxJPODsrGhjaIg2++79lwhsBYtpujc6UdxFhgpffc="

before_install:
  - wget -O ~/codacy-coverage-reporter-assembly.jar https://oss.sonatype.org/service/local/repositories/releases/content/com/codacy/codacy-coverage-reporter/1.0.13/codacy-coverage-reporter-1.0.13-assembly.jar

after_success:
  - java -cp ~/codacy-coverage-reporter-assembly.jar com.codacy.CodacyCoverageReporter -l Java -r build-reporting/target/coverage-reports/jacoco.xml
  - ./coverity_scan.sh

deploy:
  - provider: script
    script: mvn --settings .travis.settings.xml source:jar javadoc:jar deploy -DskipTests=true
    skip_cleanup: true
    on:
      branch: master
  - provider: pages
    skip_cleanup: true
    local_dir: target/staging
    github_token: $GITHUB_TOKEN
    on:
      tags: true
      branch: master
 